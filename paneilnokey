-- SCRIPT ANTILAG + PAINEL + NO-WALLS COMBINADO
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local CollectionService = game:GetService("CollectionService")
local StatsService = game:GetService("Stats")
local LocalPlayer = Players.LocalPlayer
local CoreGui = game:GetService("CoreGui")
local Workspace = game:GetService("Workspace")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- ============ CONFIGURAÃ‡Ã•ES =============
local SHOW_FPS_PING = true
local ENABLE_BRAINHOT_ESP = true
local ENABLE_ANTI_AURA_LAG = true
local ENABLE_STRIP_SKINS = true
local ENABLE_NO_WALLS = true -- NOVA FUNCIONALIDADE
local DEBUG_ESP = false -- Debug para ESP (desabilitado para menos logs)

-- ============ PAINEL CONFIG =============
local PAINEL_SEMPRE_VISIVEL = true -- true = sempre visÃ­vel, false = pode minimizar
local PAINEL_TECLA_MINIMIZAR = nil -- nil = sem tecla, ou Enum.KeyCode.XXX (ex: Enum.KeyCode.F1)
-- OpÃ§Ãµes de tecla: Enum.KeyCode.F1, Enum.KeyCode.F2, Enum.KeyCode.Insert, Enum.KeyCode.End, etc.

-- VariÃ¡veis
local fpsPingGui = nil
local frameCount = 0
local lastFpsUpdate = 0
local currentFps = 0
local brainhotHighlights = {}
local lastAuraScan = 0
local playersProcessados = {} -- Para NO-WALLS

-- Lista de brainhots (baseada nos caminhos do ReplicatedStorage)
local allowSecretByName = {
    -- Animals
    ["La Sahur Combinasion"] = true,
    ["Graipuss Medussi"] = true,
    ["Pot Hotspot"] = true,
    ["Chicleteira Bicicleteira"] = true,
    ["La Grande Combinasion"] = true,
    ["Los Combinasionas"] = true,
    ["Nuclearo Dinossauro"] = true,
    ["Los Hotspotsitos"] = true,
    ["Tralaledon"] = true,
    ["Ketupat Kepat"] = true,
    ["Los Bros"] = true,
    ["La Supreme Combinasion"] = true,
    ["Ketchuru and Musturu"] = true,
    ["Garama and Madundung"] = true,
    ["Spaghetti Tualetti"] = true,
    ["Dragon Cannelloni"] = true,
    ["Secret Lucky Block"] = true,
    ["Esok Sekolah"] = true,
}

-- FunÃ§Ã£o para verificar se existe no ReplicatedStorage
local function checkReplicatedStorageModel(petName)
    local success, result = pcall(function()
        -- Todos os brainhots estÃ£o em ReplicatedStorage.Models.Animals
        return ReplicatedStorage:FindFirstChild("Models") and
               ReplicatedStorage.Models:FindFirstChild("Animals") and
               ReplicatedStorage.Models.Animals:FindFirstChild(petName)
    end)
    
    return success and result
end

-- Comandos do painel
local ADMIN_COMMANDS = {"ragdoll","balloon","jail","morph","jumpscare","inverse","tiny","rocket"}

-- ============ NO-WALLS FUNCTIONS =============
local function tornarTranslucido(parte)
    if parte and parte:IsA("BasePart") then
        pcall(function()
            parte.Transparency = 0.5
            parte.CanCollide = true -- MantÃ©m colisÃ£o
        end)
    end
end

local function processarBases()
    if not ENABLE_NO_WALLS then return end
    
    local plots = Workspace:FindFirstChild("Plots")
    if not plots then return end
    
    for _, plot in pairs(plots:GetChildren()) do
        local decorations = plot:FindFirstChild("Decorations")
        if decorations then
            -- Processar todos os descendentes
            for _, descendant in pairs(decorations:GetDescendants()) do
                if descendant:IsA("BasePart") then
                    local nome = descendant.Name:lower()
                    if string.find(nome, "wall") or 
                       string.find(nome, "side") or
                       string.find(nome, "structure") or
                       string.find(nome, "base") or
                       string.find(nome, "home") or
                       string.find(nome, "parede") then
                        tornarTranslucido(descendant)
                    end
                end
            end
        end
    end
end

local function quandoPlayerEntra(player)
    if not ENABLE_NO_WALLS then return end
    if playersProcessados[player.UserId] then return end
    
    print("ðŸ†• Player entrou: " .. player.Name)
    
    -- Aguardar character
    if not player.Character then
        player.CharacterAdded:Wait()
        task.wait(1)
    end
    
    -- Processar bases quando player entra
    task.wait(0.5)
    processarBases()
    
    -- Marcar como processado
    playersProcessados[player.UserId] = true
    print("âœ… Player processado: " .. player.Name)
end

-- ============ FPS/PING DISPLAY =============
local function createFpsPingDisplay()
    if not SHOW_FPS_PING then return end
    
    if fpsPingGui then
        fpsPingGui:Destroy()
    end
    
    fpsPingGui = Instance.new("ScreenGui")
    fpsPingGui.Name = "FpsPingDisplay"
    fpsPingGui.ResetOnSpawn = false
    fpsPingGui.Parent = CoreGui
    
    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(0, 200, 0, 40)
    frame.Position = UDim2.new(0.5, -100, 0, 10)
    frame.BackgroundTransparency = 0.8
    frame.BackgroundColor3 = Color3.new(0, 0, 0)
    frame.BorderSizePixel = 0
    frame.Parent = fpsPingGui
    
    local fpsLabel = Instance.new("TextLabel")
    fpsLabel.Size = UDim2.new(0.5, 0, 1, 0)
    fpsLabel.Position = UDim2.new(0, 0, 0, 0)
    fpsLabel.BackgroundTransparency = 1
    fpsLabel.Text = "FPS: 0"
    fpsLabel.TextColor3 = Color3.new(1, 1, 1)
    fpsLabel.TextScaled = true
    fpsLabel.Font = Enum.Font.GothamBold
    fpsLabel.TextXAlignment = Enum.TextXAlignment.Left
    fpsLabel.Parent = frame
    
    local pingLabel = Instance.new("TextLabel")
    pingLabel.Size = UDim2.new(0.5, 0, 1, 0)
    pingLabel.Position = UDim2.new(0.5, 0, 0, 0)
    pingLabel.BackgroundTransparency = 1
    pingLabel.Text = "PING: 0ms"
    pingLabel.TextColor3 = Color3.new(1, 1, 1)
    pingLabel.TextScaled = true
    pingLabel.Font = Enum.Font.GothamBold
    pingLabel.TextXAlignment = Enum.TextXAlignment.Right
    pingLabel.Parent = frame
    
    return fpsLabel, pingLabel
end

local function updateFpsCounter()
    frameCount = frameCount + 1
    local currentTime = tick()
    if currentTime - lastFpsUpdate >= 0.5 then
        currentFps = math.floor(frameCount / (currentTime - lastFpsUpdate))
        frameCount = 0
        lastFpsUpdate = currentTime
        return true
    end
    return false
end

local function updateFpsPingDisplay(fpsLabel, pingLabel)
    if not SHOW_FPS_PING or not fpsLabel or not pingLabel then return end
    
    fpsLabel.Text = "FPS: " .. currentFps
    
    local success, pingValue = pcall(function()
        local stats = StatsService:FindFirstChild("PerformanceStats")
        if stats then
            local pingStats = stats:FindFirstChild("Ping")
            if pingStats then
                return math.floor(pingStats:GetValue())
            end
        end
        return "N/A"
    end)
    
    pingLabel.Text = "PING: " .. (success and pingValue or "N/A") .. (success and "ms" or "")
    
    -- Efeito rainbow
    local time = tick()
    local r = math.sin(time * 1) * 0.5 + 0.5
    local g = math.sin(time * 1 + 2) * 0.5 + 0.5
    local b = math.sin(time * 1 + 4) * 0.5 + 0.5
    local rainbowColor = Color3.new(r, g, b)
    fpsLabel.TextColor3 = rainbowColor
    pingLabel.TextColor3 = rainbowColor
end

-- ============ ANTI-AURA SYSTEM OTIMIZADO =============
local aurasRemovidas = 0

-- FunÃ§Ã£o para remover auras dos brainhots no ReplicatedStorage
local function removeBrainhotAuras()
    if not ENABLE_ANTI_AURA_LAG then return end
    
    local success, result = pcall(function()
        local totalRemovidas = 0
        
        for animalName, _ in pairs(allowSecretByName) do
            local animalModel = ReplicatedStorage:FindFirstChild("Models") and
                               ReplicatedStorage.Models:FindFirstChild("Animals") and
                               ReplicatedStorage.Models.Animals:FindFirstChild(animalName)
            
            if animalModel then
                local vfxInstance = animalModel:FindFirstChild("VfxInstance")
                if vfxInstance then
                    -- Remove aura1, aura2, aura3
                    for i = 1, 3 do
                        local auraName = "aura" .. i
                        local aura = vfxInstance:FindFirstChild(auraName)
                        
                        if aura then
                            pcall(function()
                                aura:Destroy()
                            end)
                            totalRemovidas = totalRemovidas + 1
                        end
                    end
                end
            end
        end
        
        return totalRemovidas
    end)
    
    if success and result > 0 then
        aurasRemovidas = aurasRemovidas + result
        if DEBUG_ESP then print("ðŸš« Removidas " .. result .. " auras dos brainhots (Total: " .. aurasRemovidas .. ")") end
    end
end

-- FunÃ§Ã£o para remover auras de pets no mundo
local function removeWorldAuras()
    if not ENABLE_ANTI_AURA_LAG then return end
    
    local plots = Workspace:FindFirstChild("Plots")
    if not plots then return end
    
    for _, plot in pairs(plots:GetChildren()) do
        local animalPodiums = plot:FindFirstChild('AnimalPodiums')
        if animalPodiums then
            for _, podium in pairs(animalPodiums:GetChildren()) do
                local base = podium:FindFirstChild('Base')
                if base then
                    local spawn = base:FindFirstChild('Spawn')
                    if spawn then
                        local attachment = spawn:FindFirstChild('Attachment')
                        if attachment then
                            local animalOverhead = attachment:FindFirstChild('AnimalOverhead')
                            if animalOverhead then
                                local displayName = animalOverhead:FindFirstChild('DisplayName')
                                if displayName then
                                    local petName = displayName.Text
                                    if allowSecretByName[petName] then
                                        -- Remove auras do pet no mundo
                                        for _, descendant in pairs(animalOverhead:GetDescendants()) do
                                            if descendant:IsA("ParticleEmitter") or 
                                               descendant:IsA("Fire") or 
                                               descendant:IsA("Smoke") or 
                                               descendant:IsA("Sparkles") or
                                               descendant:IsA("Beam") or
                                               descendant:IsA("Trail") or
                                               string.find(descendant.Name:lower(), "aura") then
                                                
                                                pcall(function()
                                                    if descendant.Enabled ~= nil then
                                                        descendant.Enabled = false
                                                    end
                                                    descendant:Destroy()
                                                end)
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
end

-- FunÃ§Ã£o original para remover auras de players
local function removePlayerAuras()
    if not ENABLE_ANTI_AURA_LAG then return end
    if tick() - lastAuraScan < 3.0 then return end
    
    lastAuraScan = tick()
    
    for _, player in ipairs(Players:GetPlayers()) do
        if player and player.Character then
            for _, descendant in ipairs(player.Character:GetDescendants()) do
                if descendant and not CollectionService:HasTag(descendant, "AntiAuraProcessed") then
                    if descendant:IsA("ParticleEmitter") or descendant:IsA("Fire") or descendant:IsA("Smoke") or descendant:IsA("Sparkles") then
                        pcall(function()
                            if descendant.Enabled ~= nil then
                                descendant.Enabled = false
                            end
                            task.spawn(function()
                                task.wait(0.1)
                                pcall(function()
                                    descendant:Destroy()
                                end)
                            end)
                        end)
                        CollectionService:AddTag(descendant, "AntiAuraProcessed")
                    end
                end
            end
        end
    end
end

-- FunÃ§Ã£o principal que chama todas as outras
local function removeAuraEffects()
    task.spawn(removeBrainhotAuras)
    task.spawn(removeWorldAuras)
    task.spawn(removePlayerAuras)
end

-- ============ BRAINHOT ESP =============
local function createBrainhotHighlight(part, ownerName)
    if not part or not part:IsA("BasePart") then return end
    
    local hl = Instance.new("Highlight")
    hl.Name = "BrainhotESP"
    hl.FillTransparency = 0.3
    hl.OutlineColor = Color3.fromRGB(255, 50, 50)
    hl.FillColor = Color3.fromRGB(255, 150, 150)
    hl.OutlineTransparency = 0
    hl.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
    hl.Parent = part
    
    local billboard = Instance.new("BillboardGui")
    billboard.Name = "BrainhotName"
    billboard.Size = UDim2.new(0, 300, 0, 80)
    billboard.StudsOffset = Vector3.new(0, 4, 0)
    billboard.AlwaysOnTop = true
    billboard.Parent = part
    
    local nameLabel = Instance.new("TextLabel")
    nameLabel.Size = UDim2.new(1, 0, 0.5, 0)
    nameLabel.Position = UDim2.new(0, 0, 0, 0)
    nameLabel.BackgroundTransparency = 1
    nameLabel.Text = part:FindFirstChild('DisplayName') and part.DisplayName.Text or "Unknown"
    nameLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    nameLabel.TextScaled = true
    nameLabel.Font = Enum.Font.GothamBold
    nameLabel.TextStrokeTransparency = 0
    nameLabel.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
    nameLabel.Parent = billboard
    
    local ownerLabel = Instance.new("TextLabel")
    ownerLabel.Size = UDim2.new(1, 0, 0.5, 0)
    ownerLabel.Position = UDim2.new(0, 0, 0.5, 0)
    ownerLabel.BackgroundTransparency = 1
    ownerLabel.Text = "Dono: " .. (ownerName or "Unknown")
    ownerLabel.TextColor3 = Color3.fromRGB(255, 255, 0)
    ownerLabel.TextScaled = true
    ownerLabel.Font = Enum.Font.Gotham
    ownerLabel.TextStrokeTransparency = 0
    ownerLabel.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
    ownerLabel.Parent = billboard
    
    return hl
end

local function scanForBrainhots()
    if not ENABLE_BRAINHOT_ESP then 
        return 
    end
    
    local plots = Workspace:FindFirstChild("Plots")
    if not plots then 
        return 
    end
    
    local brainhotsEncontrados = 0
    local totalPets = 0
    local secretPets = 0
    
    for _, plot in pairs(plots:GetChildren()) do
        local plotSign = plot:FindFirstChild('PlotSign')
        local ownerName = plotSign and 
                         plotSign:FindFirstChild('SurfaceGui') and 
                         plotSign.SurfaceGui:FindFirstChild('Frame') and 
                         plotSign.SurfaceGui.Frame:FindFirstChild('TextLabel') and 
                         plotSign.SurfaceGui.Frame.TextLabel.Text
        
        if ownerName and plot:FindFirstChild('AnimalPodiums') then
            ownerName = ownerName:gsub("'s Base", ""):gsub("%s+$", "")
            
            for _, podium in pairs(plot.AnimalPodiums:GetChildren()) do
                totalPets = totalPets + 1
                
                local animalOverhead = podium:FindFirstChild('Base') and 
                                     podium.Base:FindFirstChild('Spawn') and 
                                     podium.Base.Spawn:FindFirstChild('Attachment') and 
                                     podium.Base.Spawn.Attachment:FindFirstChild('AnimalOverhead')
                
                if animalOverhead then
                    local rarity = animalOverhead:FindFirstChild('Rarity')
                    if rarity and rarity.Text == "Secret" then
                        secretPets = secretPets + 1
                        local displayName = animalOverhead:FindFirstChild('DisplayName')
                        if displayName then
                            local petName = displayName.Text
                            
                            if allowSecretByName[petName] then
                                -- Verifica se existe no ReplicatedStorage
                                if checkReplicatedStorageModel(petName) then
                                    if not brainhotHighlights[animalOverhead] then
                                        brainhotsEncontrados = brainhotsEncontrados + 1
                                        if DEBUG_ESP then print("ðŸŽ‰ BRAINHOT ENCONTRADO: " .. petName .. " (Dono: " .. ownerName .. ")") end
                                        
                                        local highlight = createBrainhotHighlight(animalOverhead, ownerName)
                                        brainhotHighlights[animalOverhead] = highlight
                                        
                                        animalOverhead.AncestryChanged:Connect(function()
                                            if not animalOverhead.Parent and brainhotHighlights[animalOverhead] then
                                                brainhotHighlights[animalOverhead]:Destroy()
                                                brainhotHighlights[animalOverhead] = nil
                                            end
                                        end)
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    
    -- Limpa highlights invÃ¡lidos
    for animalOverhead, highlight in pairs(brainhotHighlights) do
        if not animalOverhead.Parent then
            highlight:Destroy()
            brainhotHighlights[animalOverhead] = nil
        else
            local rarity = animalOverhead:FindFirstChild('Rarity')
            local displayName = animalOverhead:FindFirstChild('DisplayName')
            if not rarity or not displayName or rarity.Text ~= "Secret" or not allowSecretByName[displayName.Text] then
                highlight:Destroy()
                brainhotHighlights[animalOverhead] = nil
            end
        end
    end
    
    -- Resumo do scan (apenas se encontrar brainhots)
    if DEBUG_ESP and brainhotsEncontrados > 0 then
        print("ðŸ“Š ESP: " .. brainhotsEncontrados .. " brainhots ativos")
    end
end

-- ============ ADMIN PANEL =============
local remote = ReplicatedStorage:WaitForChild("Packages"):WaitForChild("Net"):WaitForChild("RE/AdminPanelService/ExecuteCommand")

local function executarComandos(playerName)
    if not playerName or playerName == "" then return end
    
    task.spawn(function()
        for _, command in ipairs(ADMIN_COMMANDS) do
            local targetName = playerName
            if type(targetName) == "string" and string.sub(targetName, 1, 1) == "@" then
                targetName = string.sub(targetName, 2)
            end
            
            local targetPlayer = Players:FindFirstChild(targetName)
            if targetPlayer then
                if command == "rocket" then
                    task.wait(3)
                end
                remote:FireServer(targetPlayer, command)
            end
            task.wait(0.25)
        end
    end)
end

local function createAdminPanel()
    local playerGui = LocalPlayer:WaitForChild("PlayerGui")
    
    if playerGui:FindFirstChild("CmdUI") then
        playerGui.CmdUI:Destroy()
    end
    
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "CmdUI"
    screenGui.ResetOnSpawn = false
    screenGui.DisplayOrder = 999
    screenGui.Parent = playerGui
    
    local mainFrame = Instance.new("Frame")
    mainFrame.Size = UDim2.new(0, 200, 0, 250)
    mainFrame.Position = UDim2.new(1, -220, 0.5, 100)
    mainFrame.BackgroundColor3 = Color3.fromRGB(14, 17, 22)
    mainFrame.BorderSizePixel = 0
    mainFrame.Active = true
    mainFrame.Draggable = true
    mainFrame.Parent = screenGui
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 15)
    corner.Parent = mainFrame
    
    local stroke = Instance.new("UIStroke")
    stroke.Thickness = 1
    stroke.Color = Color3.fromRGB(70, 70, 100)
    stroke.Transparency = 0.3
    stroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    stroke.Parent = mainFrame
    
    local titleFrame = Instance.new("Frame")
    titleFrame.Size = UDim2.new(1, 0, 0, 40)
    titleFrame.Position = UDim2.new(0, 0, 0, 0)
    titleFrame.BackgroundColor3 = Color3.fromRGB(14, 17, 22)
    titleFrame.BorderSizePixel = 0
    titleFrame.Parent = mainFrame
    
    local titleCorner = Instance.new("UICorner")
    titleCorner.CornerRadius = UDim.new(0, 15)
    titleCorner.Parent = titleFrame
    
    local titleLabel = Instance.new("TextLabel")
    titleLabel.Size = UDim2.new(1, -20, 1, 0)
    titleLabel.Position = UDim2.new(0, 10, 0, 0)
    titleLabel.BackgroundTransparency = 1
    titleLabel.Text = "FleischPanel"
    titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.TextSize = 18
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left
    titleLabel.Parent = titleFrame
    
    local isHidden = false
    
    local function togglePanel()
        if isHidden then
            mainFrame.Visible = true
            isHidden = false
        else
            mainFrame.Visible = false
            isHidden = true
        end
    end
    
    -- ConfiguraÃ§Ã£o do controle do painel
    if not PAINEL_SEMPRE_VISIVEL and PAINEL_TECLA_MINIMIZAR then
        UserInputService.InputBegan:Connect(function(input, gameProcessed)
            if gameProcessed then return end
            if input.KeyCode == PAINEL_TECLA_MINIMIZAR then
                togglePanel()
            end
        end)
    end
    
    local scrollFrame = Instance.new("ScrollingFrame")
    scrollFrame.Size = UDim2.new(1, -20, 1, -60)
    scrollFrame.Position = UDim2.new(0, 10, 0, 60)
    scrollFrame.BackgroundColor3 = Color3.fromRGB(14, 17, 22)
    scrollFrame.BorderSizePixel = 0
    scrollFrame.ScrollBarThickness = 8
    scrollFrame.ScrollBarImageColor3 = Color3.fromRGB(100, 100, 120)
    scrollFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
    scrollFrame.AutomaticCanvasSize = Enum.AutomaticSize.Y
    scrollFrame.Parent = mainFrame
    
    local scrollCorner = Instance.new("UICorner")
    scrollCorner.CornerRadius = UDim.new(0, 10)
    scrollCorner.Parent = scrollFrame
    
    local listLayout = Instance.new("UIListLayout")
    listLayout.Parent = scrollFrame
    listLayout.Padding = UDim.new(0, 8)
    listLayout.SortOrder = Enum.SortOrder.LayoutOrder
    
    local padding = Instance.new("UIPadding")
    padding.PaddingTop = UDim.new(0, 8)
    padding.PaddingBottom = UDim.new(0, 8)
    padding.PaddingLeft = UDim.new(0, 8)
    padding.PaddingRight = UDim.new(0, 8)
    padding.Parent = scrollFrame
    
    local function createPlayerButton(player)
        local button = Instance.new("TextButton")
        button.Size = UDim2.new(1, -16, 0, 40)
        button.BackgroundColor3 = Color3.fromRGB(14, 17, 22)
        button.Text = ""
        button.BorderSizePixel = 0
        button.AutoButtonColor = false
        button.Parent = scrollFrame
        
        local buttonCorner = Instance.new("UICorner")
        buttonCorner.CornerRadius = UDim.new(0, 10)
        buttonCorner.Parent = button
        
        local buttonStroke = Instance.new("UIStroke")
        buttonStroke.Thickness = 1
        buttonStroke.Color = Color3.fromRGB(70, 70, 100)
        buttonStroke.Transparency = 0.4
        buttonStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
        buttonStroke.Parent = button
        
        local nameLabel = Instance.new("TextLabel")
        nameLabel.Size = UDim2.new(1, -50, 1, 0)
        nameLabel.Position = UDim2.new(0, 10, 0, 0)
        nameLabel.BackgroundTransparency = 1
        nameLabel.Text = player.Name
        nameLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        nameLabel.Font = Enum.Font.GothamBold
        nameLabel.TextSize = 14
        nameLabel.TextXAlignment = Enum.TextXAlignment.Left
        nameLabel.Parent = button
        
        local hoverTween = TweenService:Create(button, TweenInfo.new(0.15, Enum.EasingStyle.Sine, Enum.EasingDirection.Out), {
            BackgroundColor3 = Color3.fromRGB(24, 28, 36)
        })
        
        local leaveTween = TweenService:Create(button, TweenInfo.new(0.2, Enum.EasingStyle.Sine, Enum.EasingDirection.Out), {
            BackgroundColor3 = Color3.fromRGB(14, 17, 22)
        })
        
        button.MouseEnter:Connect(function()
            hoverTween:Play()
        end)
        
        button.MouseLeave:Connect(function()
            leaveTween:Play()
        end)
        
        button.MouseButton1Click:Connect(function()
            executarComandos(player.Name)
        end)
    end
    
    local function updatePlayerList()
        for _, child in ipairs(scrollFrame:GetChildren()) do
            if child:IsA("TextButton") then
                child:Destroy()
            end
        end
        
        local playersList = {}
        for _, player in ipairs(Players:GetPlayers()) do
            if player ~= LocalPlayer then
                table.insert(playersList, player)
            end
        end
        
        for _, player in ipairs(playersList) do
            createPlayerButton(player)
        end
    end
    
    task.spawn(function()
        while screenGui.Parent do
            updatePlayerList()
            task.wait(2)
        end
    end)
    
    updatePlayerList()
end

-- ============ STRIP SKINS =============
local function stripCharacter(character)
    if not ENABLE_STRIP_SKINS or not character then return end
    
    for _, item in pairs(character:GetChildren()) do
        if item:IsA("Accessory") or item:IsA("Hat") then
            pcall(item.Destroy, item)
        end
    end
    
    for _, part in pairs(character:GetDescendants()) do
        if part:IsA("Shirt") or part:IsA("Pants") or part:IsA("ShirtGraphic") then
            pcall(part.Destroy, part)
        elseif part:IsA("CharacterMesh") then
            pcall(part.Destroy, part)
        elseif part:IsA("Decal") or part:IsA("Texture") then
            pcall(part.Destroy, part)
        elseif part:IsA("SurfaceAppearance") then
            pcall(part.Destroy, part)
        end
    end
end

-- ============ INICIALIZAÃ‡ÃƒO =============
local fpsLabel, pingLabel = nil, nil
if SHOW_FPS_PING then
    fpsLabel, pingLabel = createFpsPingDisplay()
    lastFpsUpdate = tick()
end

-- Processar players iniciais para NO-WALLS
if ENABLE_NO_WALLS then
    for _, player in pairs(Players:GetPlayers()) do
        quandoPlayerEntra(player)
    end
end

-- ============ MAIN LOOP =============
local frameCounter = 0
local auraCounter = 0
local brainhotCounter = 0
local stripCounter = 0
local nowallsCounter = 0

RunService.Heartbeat:Connect(function(deltaTime)
    -- FPS Counter
    if updateFpsCounter() then
        updateFpsPingDisplay(fpsLabel, pingLabel)
    end
    
    frameCounter = frameCounter + 1
    auraCounter = auraCounter + 1
    brainhotCounter = brainhotCounter + 1
    stripCounter = stripCounter + 1
    nowallsCounter = nowallsCounter + 1
    
    -- Anti-Aura otimizado (a cada 30 frames)
    if auraCounter >= 30 then
        auraCounter = 0
        task.spawn(removeAuraEffects)
    end
    
    -- Brainhot ESP (a cada 30 frames)
    if brainhotCounter >= 30 then
        brainhotCounter = 0
        task.spawn(scanForBrainhots)
    end
    
    -- Strip Skins (a cada 180 frames)
    if stripCounter >= 180 then
        stripCounter = 0
        task.spawn(function()
            for _, player in ipairs(Players:GetPlayers()) do
                if player ~= LocalPlayer and player.Character then
                    for _, item in pairs(player.Character:GetChildren()) do
                        if item:IsA("Accessory") or item:IsA("Hat") or 
                           item:IsA("Shirt") or item:IsA("Pants") or item:IsA("ShirtGraphic") then
                            pcall(item.Destroy, item)
                        end
                    end
                end
            end
        end)
    end
    
    -- NO-WALLS (a cada 300 frames = ~5 segundos)
    if ENABLE_NO_WALLS and nowallsCounter >= 300 then
        nowallsCounter = 0
        task.spawn(processarBases)
    end
end)

-- ============ PLAYER EVENTS =============
Players.PlayerAdded:Connect(function(player)
    -- NO-WALLS: Processar quando player entra
    if ENABLE_NO_WALLS then
        task.spawn(function()
            quandoPlayerEntra(player)
        end)
    end
end)

Players.PlayerRemoving:Connect(function(player)
    -- Cleanup
    if playersProcessados[player.UserId] then
        playersProcessados[player.UserId] = nil
    end
end)

-- ============ DELAYED INITIALIZATION =============
task.delay(1, scanForBrainhots)
task.delay(1, createAdminPanel)
if ENABLE_NO_WALLS then
    task.delay(2, processarBases)
end
if ENABLE_ANTI_AURA_LAG then
    task.delay(0.5, removeBrainhotAuras) -- Remove auras dos brainhots imediatamente
end

-- ============ STARTUP MESSAGE =============
print(("="):rep(60))
print("âœ“ SCRIPT ANTILAG + ADMIN PANEL + NO-WALLS COMBINADO ATIVADO")
print("â†’ Display de FPS/PING ativado (sistema Ãºnico)")
print("â†’ ESP para brainhots especiais ativado")
print("â†’ Anti-lag OTIMIZADO para auras dos brainhots ativado")
print("â†’ Remove aura1, aura2, aura3 de cada brainhot")
print("â†’ RemoÃ§Ã£o otimizada de skins/roupas/acessÃ³rios")
if PAINEL_SEMPRE_VISIVEL then
    print("â†’ Painel de administraÃ§Ã£o sempre visÃ­vel")
elseif PAINEL_TECLA_MINIMIZAR then
    print("â†’ Painel de administraÃ§Ã£o com tecla personalizada")
else
    print("â†’ Painel de administraÃ§Ã£o sem tecla de minimizar")
end
print("â†’ Sistema de FPS Ãºnico e correto")
print("â†’ Loop otimizado com task.spawn")
print("â†’ ESP de brainhots corrigido para detectar em Plots")
print("â†’ Mostra nome do brainhot e dono")
print("â†’ Comandos: ragdoll, balloon, jail, morph, jumpscare, inverse, tiny, rocket")
print("â†’ NO-WALLS: Paredes translÃºcidas quando player entra")
print("â†’ NO-WALLS: Processamento contÃ­nuo das bases")
print("â†’ NO-WALLS: Detecta novos players automaticamente")
print(("="):rep(60))
