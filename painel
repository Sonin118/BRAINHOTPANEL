-- Sistema de Autentica√ß√£o BrainHot Panel
-- Loadstring: loadstring(game:HttpGet("https://raw.githubusercontent.com/Sonin118/BRAINHOTPANEL/main/paneilnokey"))()

local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- CONFIGURA√á√ïES ATUALIZADAS
local keyServiceURL = "https://raw.githubusercontent.com/Sonin118/BRAINHOTPANEL/main/KEYPAINEL"
local mainScriptURL = "https://raw.githubusercontent.com/Sonin118/BRAINHOTPANEL/main/paneilnokey" -- AGORA √â UM LOADSTRING!

-- Conectar eventos remotos para evitar warnings
local function connectRemoteEvents()
    pcall(function()
        local packages = ReplicatedStorage:FindFirstChild("Packages")
        if packages then
            local net_ure = packages:FindFirstChild("Net_URE")
            if net_ure then
                net_ure.OnClientEvent:Connect(function(...)
                    -- Handle remote events aqui
                    warn("Net_URE event received:", ...)
                end)
            end
        end
    end)
end

-- Fun√ß√£o segura para verificar a chave
local function checkKey(inputKey)
    local success, currentValidKey = pcall(function()
        local response = game:HttpGet(keyServiceURL, true)
        return string.gsub(response, "%s+", "")
    end)
    
    if success and currentValidKey then
        inputKey = string.gsub(inputKey, "%s+", "")
        return inputKey == currentValidKey
    else
        warn("Erro ao verificar key: ", currentValidKey)
        return false
    end
end

-- Fun√ß√£o segura para carregar o script principal COMO LOADSTRING
local function loadMainScript()
    local success, err = pcall(function()
        -- Obt√©m o c√≥digo do loadstring
        local scriptCode = game:HttpGet(mainScriptURL, true)
        
        if scriptCode and string.find(scriptCode, "function") or string.find(scriptCode, "loadstring") then
            -- Executa como loadstring
            local mainScript = loadstring(scriptCode)
            if mainScript then
                mainScript() -- Executa o script do painel
            else
                error("Falha ao compilar o loadstring do painel")
            end
        else
            error("C√≥digo do painel n√£o encontrado ou inv√°lido")
        end
    end)
    
    if not success then
        warn("Erro ao carregar panel: ", err)
        return false
    end
    return true
end

-- Fun√ß√£o para criar a interface gr√°fica (mantida igual)
local function createKeyUI()
    -- Cria a tela principal
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "BrainHotAuthGui"
    screenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
    screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    screenGui.ResetOnSpawn = false

    -- Cria o frame (janela)
    local mainFrame = Instance.new("Frame")
    mainFrame.Size = UDim2.new(0, 400, 0, 250)
    mainFrame.Position = UDim2.new(0.5, -200, 0.5, -125)
    mainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
    mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
    mainFrame.BorderSizePixel = 0
    mainFrame.ClipsDescendants = true
    mainFrame.Parent = screenGui

    -- Efeito de sombra
    local shadow = Instance.new("ImageLabel")
    shadow.Name = "Shadow"
    shadow.Image = "rbxassetid://7330690775"
    shadow.ScaleType = Enum.ScaleType.Slice
    shadow.SliceCenter = Rect.new(30, 30, 270, 270)
    shadow.ImageTransparency = 0.8
    shadow.Size = UDim2.new(1, 30, 1, 30)
    shadow.Position = UDim2.new(0, -15, 0, -15)
    shadow.BackgroundTransparency = 1
    shadow.Parent = mainFrame
    shadow.ZIndex = -1

    -- Arredonda os cantos
    local UICorner = Instance.new("UICorner")
    UICorner.CornerRadius = UDim.new(0, 10)
    UICorner.Parent = mainFrame

    -- T√≠tulo
    local titleLabel = Instance.new("TextLabel")
    titleLabel.Text = "üîê BRAINHOT PANEL"
    titleLabel.Size = UDim2.new(1, 0, 0, 50)
    titleLabel.Position = UDim2.new(0, 0, 0, 0)
    titleLabel.BackgroundColor3 = Color3.fromRGB(25, 25, 30)
    titleLabel.TextColor3 = Color3.fromRGB(220, 220, 255)
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.TextSize = 18
    titleLabel.Parent = mainFrame

    -- Instru√ß√£o
    local instructionLabel = Instance.new("TextLabel")
    instructionLabel.Text = "Digite a key fornecida para acessar:"
    instructionLabel.Size = UDim2.new(0.9, 0, 0, 20)
    instructionLabel.Position = UDim2.new(0.05, 0, 0.25, 0)
    instructionLabel.BackgroundTransparency = 1
    instructionLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
    instructionLabel.Font = Enum.Font.Gotham
    instructionLabel.TextSize = 14
    instructionLabel.TextXAlignment = Enum.TextXAlignment.Left
    instructionLabel.Parent = mainFrame

    -- Campo de texto para a key
    local keyTextBox = Instance.new("TextBox")
    keyTextBox.PlaceholderText = "Cole a key aqui..."
    keyTextBox.Size = UDim2.new(0.9, 0, 0, 45)
    keyTextBox.Position = UDim2.new(0.05, 0, 0.4, 0)
    keyTextBox.BackgroundColor3 = Color3.fromRGB(45, 45, 50)
    keyTextBox.TextColor3 = Color3.fromRGB(255, 255, 255)
    keyTextBox.Font = Enum.Font.Gotham
    keyTextBox.TextSize = 16
    keyTextBox.ClearTextOnFocus = false
    keyTextBox.Text = ""
    keyTextBox.Parent = mainFrame

    -- Estilizar o campo de texto
    local textBoxCorner = Instance.new("UICorner")
    textBoxCorner.CornerRadius = UDim.new(0, 6)
    textBoxCorner.Parent = keyTextBox

    -- Bot√£o de enviar
    local submitButton = Instance.new("TextButton")
    submitButton.Text = "‚ñ∂Ô∏è  ACESSAR PANEL"
    submitButton.Size = UDim2.new(0.9, 0, 0, 45)
    submitButton.Position = UDim2.new(0.05, 0, 0.65, 0)
    submitButton.BackgroundColor3 = Color3.fromRGB(0, 120, 215)
    submitButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    submitButton.Font = Enum.Font.GothamBold
    submitButton.TextSize = 16
    submitButton.AutoButtonColor = true
    submitButton.Parent = mainFrame

    -- Estilizar o bot√£o
    local buttonCorner = Instance.new("UICorner")
    buttonCorner.CornerRadius = UDim.new(0, 6)
    buttonCorner.Parent = submitButton

    -- Label para mensagens
    local messageLabel = Instance.new("TextLabel")
    messageLabel.Text = ""
    messageLabel.Size = UDim2.new(0.9, 0, 0, 20)
    messageLabel.Position = UDim2.new(0.05, 0, 0.85, 0)
    messageLabel.BackgroundTransparency = 1
    messageLabel.TextColor3 = Color3.fromRGB(255, 50, 50)
    messageLabel.Font = Enum.Font.Gotham
    messageLabel.TextSize = 12
    messageLabel.Parent = mainFrame

    -- Focar no campo de texto automaticamente
    keyTextBox:CaptureFocus()

    -- Fun√ß√£o principal do bot√£o
    submitButton.MouseButton1Click:Connect(function()
        local key = string.gsub(keyTextBox.Text, "%s+", "") -- Remove espa√ßos
        if key == "" then
            messageLabel.Text = "Por favor, digite uma key."
            return
        end

        messageLabel.Text = "Verificando key..."
        messageLabel.TextColor3 = Color3.fromRGB(255, 255, 150)

        -- Desabilita o bot√£o para evitar cliques duplos
        submitButton.AutoButtonColor = false
        submitButton.Text = "‚è≥ VERIFICANDO..."
        submitButton.BackgroundColor3 = Color3.fromRGB(100, 100, 100)

        task.wait(1.5) -- Tempo de verifica√ß√£o

        if checkKey(key) then
            -- Key V√ÅLIDA
            messageLabel.Text = "‚úÖ Key v√°lida! Acessando panel..."
            messageLabel.TextColor3 = Color3.fromRGB(50, 255, 50)
            submitButton.Text = "‚úÖ SUCESSO!"

            -- Salva a key no workspace do executor
            pcall(function()
                writefile("brainhot_key.txt", key)
            end)

            task.wait(1.5)

            -- Destroi a interface e carrega o script principal COMO LOADSTRING
            screenGui:Destroy()
            loadMainScript()

        else
            -- Key INV√ÅLIDA
            messageLabel.Text = "‚ùå KEY INV√ÅLIDA OU EXPIRADA!"
            messageLabel.TextColor3 = Color3.fromRGB(255, 80, 80)
            keyTextBox.Text = ""
            keyTextBox:CaptureFocus()

            -- Reabilita o bot√£o
            submitButton.AutoButtonColor = true
            submitButton.Text = "‚ñ∂Ô∏è  TENTAR NOVAMENTE"
            submitButton.BackgroundColor3 = Color3.fromRGB(0, 120, 215)
        end
    end)

    -- Enter tamb√©m envia o formul√°rio
    keyTextBox.FocusLost:Connect(function(enterPressed)
        if enterPressed then
            submitButton:Capture()
        end
    end)
end

-- IN√çCIO DO SCRIPT
print("[[ BrainHot Panel - Sistema de Autentica√ß√£o ]]")

-- Conectar eventos remotos primeiro
connectRemoteEvents()

-- Tenta ler a key salva, se existir
local savedKey
local keyExists = pcall(function()
    savedKey = readfile("brainhot_key.txt")
end)

if keyExists and savedKey and checkKey(savedKey) then
    -- Key salva √© V√ÅLIDA: Executa direto
    print("Key salva √© v√°lida! Carregando panel...")
    if not loadMainScript() then
        -- Se falhar ao carregar, mostra a interface
        warn("Falha ao carregar panel. Abrindo interface...")
        createKeyUI()
    end
else
    -- Key N√ÉO existe ou √© INV√ÅLIDA: Mostra a interface
    print("Key n√£o encontrada ou inv√°lida. Abrindo interface...")
    createKeyUI()
end
